# **3. Выбранные UML-диаграммы и их назначение**

![классы](https://github.com/user-attachments/assets/182f5703-3659-4409-a3f3-59b8c010156c)

**Диаграмма классов**
Описание: Показывает структуру системы через основные сущности и их взаимосвязи.

Почему выбрана: Обеспечивает "скелет" системы, отображая классы (товары, зоны, сотрудники) и их атрибуты, методы и связи.

Как помогает: Критично для проектирования базы данных и разработки API.

Детали диаграммы (см. предоставленную диаграмму):

Интерпретация: Диаграмма определяет, из чего состоит система, включая атрибуты и методы каждого класса, что упрощает проектирование схемы базы данных.

![последовательности](https://github.com/user-attachments/assets/729d9502-2148-44b1-9cf8-f858c6daac3a)

Диаграмма последовательностей

Почему выбрана: Иллюстрирует динамику работы системы (например, процесс приемки товара).

Как помогает: Позволяет выявить "узкие места" в бизнес-процессах до начала программирования.

Как диаграммы раскрывают архитектуру
Диаграмма классов: Отвечает на вопрос "Из чего состоит система?" (классы, атрибуты, методы).

Диаграмма последовательностей: Показывает "Как система работает в реальных сценариях?" (взаимодействие объектов).

Диаграмма вариантов использования: Объясняет "Для кого и зачем создана система?" (роли пользователей и их цели).

# **Этап 2: Проектирование и создание базы данных для Информационной системы склада**

## **1. Схема базы данных**
База данных включает **7 таблиц** с различными типами связей:
 **Один к одному**   
 **Один ко многим**   
 **Многие ко многим**   

### **Структура таблиц**  
#### **1. Пользователи (`users`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `user_id`     | `SERIAL`       | Первичный ключ (PK)         |
| `username`    | `VARCHAR(50)`  | Логин                       |
| `password`    | `VARCHAR(100)` | Хэш пароля                  |
| `role`        | `VARCHAR(20)`  | Роль (admin, keeper, accountant) |

#### **2. Товары (`products`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `product_id`  | `SERIAL`       | PK                          |
| `name`        | `VARCHAR(100)` | Название товара             |
| `sku`         | `VARCHAR(50)`  | Артикул                     |
| `price`       | `DECIMAL(10,2)`| Цена                        |

#### **3. Поставщики (`suppliers`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `supplier_id` | `SERIAL`       | PK                          |
| `name`        | `VARCHAR(100)` | Название компании           |
| `contact`     | `VARCHAR(100)` | Контактное лицо             |

#### **4. Склады (`warehouses`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `warehouse_id`| `SERIAL`       | PK                          |
| `location`    | `VARCHAR(100)` | Адрес склада                |

#### **5. Заказы (`orders`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `order_id`    | `SERIAL`       | PK                          |
| `supplier_id` | `INT`          | Внешний ключ (FK) → `suppliers` |
| `date`        | `DATE`         | Дата заказа                 |

#### **6. Записи о товарах на складе (`inventory`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `inventory_id`| `SERIAL`       | PK                          |
| `product_id`  | `INT`          | FK → `products`             |
| `warehouse_id`| `INT`          | FK → `warehouses`           |
| `quantity`    | `INT`          | Количество                  |

#### **7. Отчеты (`reports`)**
| Поле          | Тип данных      | Описание                     |
|---------------|----------------|-----------------------------|
| `report_id`   | `SERIAL`       | PK                          |
| `user_id`     | `INT`          | FK → `users`                |
| `type`        | `VARCHAR(50)`  | Тип отчета (остатки, продажи) |
| `created_at`  | `TIMESTAMP`    | Дата создания               |

---

  2. Связи между таблицами
1.(Один к одному)  
    `users` → `reports` (один пользователь может создать один отчет).  

2.(Один ко многим)  
    `suppliers` → `orders` (один поставщик может иметь много заказов).  
    `warehouses` → `inventory` (на одном складе может быть много записей о товарах).  

3.(Многие ко многим)  
    `products` ↔ `warehouses` через таблицу `inventory` (товар может быть на нескольких складах, склад содержит много товаров).  

  4. Проверка корректности
1. Тестовые запросы:
    Получение списка товаров дороже 500 ₽.
    Вывод остатков товаров по складам.

2. Валидация связей:
    При попытке удалить поставщика с существующими заказами → ошибка (если `ON DELETE RESTRICT`).
    Уникальность связей в `inventory` (товар не может дублироваться на одном складе).



# **Этап 3: Реализация консольного интерфейса для Информационной системы склада**
**Структура**

Класс ConsoleInterface
Поля: WarehouseService, ReportService, ILogger.
**Методы:**

RunAsync: Запускает цикл меню.

DisplayMenu: Отображает меню (1. Добавить товар, 2. Переместить товар, 3. Инвентаризация, 4. Отчет, 5. Выход).

AddProductAsync: Добавляет товар (название, SKU, цена).

MoveProductAsync: Перемещает товар между складами (ID товара, складов, количество).

PerformInventoryAsync: Проводит инвентаризацию (ID склада, фактические остатки).

GenerateStockReportAsync: Генерирует отчет по остаткам (ID склада).

**Особенности**
Меню: Интуитивное, с 5 командами и четкими подсказками.

Валидация ввода: Проверяет пустые строки, числа, положительные значения.

Исключения (ArgumentException) перехватываются, логируются, отображаются пользователю.

Понятные сообщения, очистка консоли после операций.

# **Этап 4: Реализация слоя работы с БД**
# **Структура**
## **1. WarehouseDbContext**
Контекст EF Core для доступа к таблицам:

Products, Inventory, Warehouses, Suppliers, Orders, Users, Reports
Уникальные индексы: sku (Products), product_id + warehouse_id (Inventory)
Связи: один-к-одному, один-ко-многим, многие-ко-многим

## **2. DatabaseManager**
Класс для CRUD-операций с логированием.
Методы для Products:

CreateProductAsync(name, sku, price): Создает товар, возвращает product_id или null
GetProductAsync(productId): Возвращает Product или null
UpdateProductAsync(productId, name, sku, price): Обновляет товар (частично)
DeleteProductAsync(productId): Удаляет товар
Методы для Inventory:

AddInventoryAsync(productId, warehouseId, quantity): Добавляет запись, проверяет уникальность
GetInventoryAsync(inventoryId): Возвращает запись с данными о товаре и складе
UpdateInventoryAsync(inventoryId, quantity): Обновляет количество
DeleteInventoryAsync(inventoryId): Удаляет запись

## **3. Обработка ошибок**
Уникальность (23505): дубликат sku или записи в inventory
Внешние ключи (23503): удаление связанных данных
Общие ошибки БД: логируются через ILogger

# **Этап 5:  Реализация бизнес-слоя**

# **Структура**
1. BaseService
Абстрактный базовый класс для общих функций.

Поля: DatabaseManager, ILogger (защищенные).
Методы: ValidateInput (виртуальный, для валидации входных данных).
Назначение: Обеспечивает наследование и общую логику для производных классов.

# **2. WarehouseService**
Сервис для складских операций, наследуется от BaseService.

Методы:
AddProductAsync(name, sku, price): Создает товар с валидацией (положительная цена, непустые строки).
MoveProductAsync(productId, fromWarehouseId, toWarehouseId, quantity): Перемещает товар между складами, проверяет наличие.
PerformInventoryAsync(warehouseId, actualQuantities): Проводит инвентаризацию, обновляет/добавляет записи.

# **3. ReportService**
Сервис для отчетов, наследуется от BaseService.

Методы:
GenerateStockReportAsync(warehouseId): Формирует отчет по остаткам на складе.

ООП:
Наследование: WarehouseService и ReportService наследуются от BaseService.
Полиморфизм: ValidateInput может быть переопределен.
Инкапсуляция: Доступ только через публичные методы, поля защищены.

Логика взаимодействует только с DatabaseManager, не зависит от UI.
Все методы используют async Task.
Валидация входных данных, обработка ошибок с логированием.


# **Работа самого приложения**
Выбор действия: 

![image](https://github.com/user-attachments/assets/a6b82050-fdd4-4812-92bc-bae00640a372)

![image](https://github.com/user-attachments/assets/0a106b4a-ad7c-4cd5-9ccf-a900ebc8521c)

SKU-это уникальный идентификатор товара, который используется в системах управления складом и продажами для учета и классификации продукции. После того как вы ввели название товара (например, "Ноутбук Dell"), SKU представляет собой код или номер, который однозначно определяет этот конкретный товар в вашей базе данных или системе.

**Проводим инвентаризацию**

![image](https://github.com/user-attachments/assets/8f15eacc-052f-435a-92c6-69cbf268c029)

**Генерация отчета**

![image](https://github.com/user-attachments/assets/12d8c9a6-d6f0-4d7f-9519-a1a32b62fd61)

![image](https://github.com/user-attachments/assets/7e94c21b-cb6e-4c18-9dd3-8dc3d617a87b)

Уровни логирования:

LogInformation: Для успешных операций (например, "Товар добавлен").

LogWarning: Для некорректных данных или ситуаций, которые не приводят к ошибке (например, "Товар не найден").

LogError: Для исключений и критических ошибок (например, "Ошибка при создании товара").

LogDebug: Для детализированных данных (например, ввод пользователя).

Где добавлено:

Логирование всех операций с базой данных в DatabaseManager.

Логирование бизнес-логики в WarehouseService и ReportService.

Логирование пользовательских действий в ConsoleInterface.

Логирование инициализации приложения в Program.
